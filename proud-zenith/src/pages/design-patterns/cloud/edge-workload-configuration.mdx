---
title: Edge Workload Configuration Pattern
translateFrom: https://docs.microsoft.com/en-us/azure/architecture/patterns/edge-workload-configuration
---

车间内各种各样的系统和设备会使工作负载配置成为一个难题。
本文提供了解决这一问题的方法。

# 问题背景

制造企业，作为其数字化转型旅程的一部分，越来越关注构建可以作为共享能力重用的软件解决方案。
由于车间内设备和系统的多样性，模块化工作负载被配置为支持不同的协议、驱动程序和数据格式。
有时，甚至一个工作负载的多个实例在相同的边缘位置使用不同的配置运行。
对于某些工作负载，配置每天更新一次以上。因此，组态管理对于扩大边缘解决方案的规模越来越重要。

# 解决方案

边缘工作负载的组态管理有几个共同特点:

* 有几个配置点可以分为不同的层，比如软件源、 CI/CD 流水线、云租户和边缘位置:
  ![edge workload configuration](/asset/img/edge-workload-configuration-1.png)
* 不同的层可以由不同的人更新。
* 无论配置如何更新，都需要仔细地跟踪和审计它们。
* 为了业务连续性，需要在边缘处可以离线访问配置。
* 还需要在云中提供配置的全局视图。

# 问题与注意事项

在决定如何实现此模式时，请考虑以下几点:

* 允许在边缘不连接到云的情况下进行编辑会显著增加组态管理的复杂性。
  将变化复制到云中是可能的，但是在以下方面存在挑战:
  - 用户身份验证，因为它依赖于像 Azure Active Directory 这样的云服务。
  - 重新连接后的冲突解决，如果工作负载收到需要手动干预的意外配置。
* 如果拓扑符合 ISA-95要求，则边缘环境可能具有与网络相关的约束。
  您可以通过选择提供跨层连接的技术来克服这些限制，例如 Azure 物联网边缘中的设备层次结构。
* 如果运行时配置与软件版本解耦，则需要单独处理配置更改。
  要提供历史记录和回滚特性，需要将过去的配置存储在云中的数据存储中。
* 配置中的错误，比如配置到不存在的端点的连接组件，可能会中断工作负载。
  因此，在可观测性解决方案中处理其他部署生命周期事件时，一定要像处理其他部署生命周期事件一样处理配置更改，
  以便可观测性指示板能够帮助将系统错误与配置更改关联起来。
  有关可观测性的更多信息，请参见云监测指南: [可观测性](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/manage/monitor/observability)。
* 了解云和边缘数据存储在业务连续性中扮演的角色。
  如果云数据存储是真理的唯一来源，那么边缘工作负载应该能够通过使用自动化流程恢复预期的状态。
* 对于弹性，边缘数据存储应该充当脱机缓存。这优先于延迟考虑。

# 何时使用

以下场景可以使用此模式：

* 需要在软件发布周期之外配置工作负载。
* 不同的人需要能够读取和更新配置。
* 即使没有连接到云，配置也需要可用。

工作负载示例：

* 连接到车间资产以获取数据的解决方案（例如 OPC Publisher）以及命令和控制
* 面向预测维修的机器学习工作负载
* 机器学习工作负载，实时检查生产线上的质量




