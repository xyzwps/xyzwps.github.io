---
layout: ./_BlogLayout.astro
title: é›†ä¸­æ—¶é—´æ®µ
date: 2025-06-10
---

## èƒŒæ™¯

äº‹æƒ…æ˜¯è¿™æ ·çš„ã€‚

æˆ‘å¸æœ€è¿‘è¦åšä¸€ä¸ªå®šæ—¶æŠ¥å‘ŠåŠŸèƒ½ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹æ˜¯è®¡ç®—å‡ºä¸€å¤© 24 å°æ—¶å†…ï¼Œå“ªäº›æ—¶é—´æ®µå†…å‡ºç°å‘Šè­¦çš„æ¬¡æ•°æ¯”è¾ƒé›†ä¸­ã€‚
ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢æ˜¯ä¸€å¤©ä¸­ä» 0 ç‚¹åˆ° 23 ç‚¹ï¼Œæ¯å°æ—¶å‡ºç°çš„å‘Šè­¦æ¬¡æ•°åˆ—è¡¨ï¼š

```json
[25, 7, 5, 4, 10, 6, 17, 10, 10, 3, 6, 5, 6, 7, 2, 5, 2, 7, 0, 3, 0, 0, 1, 1]
```

ç”»æˆæŸ±çŠ¶å›¾å¦‚ä¸‹:

![å‘Šè­¦æŸ±çŠ¶å›¾](/assets/img/blogs/jzsjd1.png)

è§‚å¯ŸæŸ±çŠ¶å›¾ï¼Œæˆ‘ä»¬å¯ä»¥éšå£ä¸€è¯´

- å‘Šè­¦é›†ä¸­åœ¨ 0 ç‚¹åˆ° 17 ç‚¹è¿™æ®µæ—¶é—´å†…ï¼ˆå¯æ˜¯è¿™éƒ½å ä¸€å¤©æ—¶é—´çš„ $\cfrac{3}{4}$ äº†ï¼Œé›†ä¸­ä¸ª P!ï¼‰
- å‘Šè­¦é›†ä¸­åœ¨ 0 ç‚¹åˆ° 8 ç‚¹è¿™æ®µæ—¶é—´å†…ï¼ˆå¥½åƒè¯´å¾—è¿‡å»ï¼Ÿï¼‰
- å‘Šè­¦é›†ä¸­åœ¨ 0 ç‚¹åˆ° 1 ç‚¹å’Œ 4 ç‚¹åˆ° 8 ç‚¹è¿™ä¸¤ä¸ªæ—¶é—´æ®µå†…ï¼ˆä½ è§‰å¾—ç¬¦åˆç›´è§‰å—ï¼Ÿï¼‰

å¯ä»¥çœ‹åˆ°ï¼Œå…·ä½“æ€ä¹ˆæ ·æ‰ç®—é›†ä¸­ï¼Œæ˜¯ç›¸å½“ä¸»è§‚çš„ã€‚

æˆ‘æƒ³ç€ï¼Œæˆ‘åº”è¯¥ä¸æ˜¯ç¬¬ä¸€ä¸ªé‡åˆ°è¿™ä¸ªé—®é¢˜çš„äººï¼Œåº”è¯¥æœ‰ç°æˆçš„ç®—æ³•æ¥æè¿™ä¸ªä¸œè¥¿ã€‚
äºæ˜¯é—®äº†ä¸‹ deepseekï¼Œç»“æœéå¸¸ä¸æ»¡æ„ã€‚

æƒ³ç€ç°åœ¨å¯æ˜¯ AI æ–°çºªå…ƒäº†ï¼Œè¿™ç§äº‹æƒ…å°±äº¤ç»™ AI æ¥æå¥½äº†ï¼

## AI ç‰ˆç®—æ³•

äºæ˜¯æˆ‘å†™äº†ä¸ª prompt è®© AI å¸®æˆ‘æ¥æã€‚å¦‚ä¸‹ï¼š

```md
ä½ æ˜¯ä¸€ä¸ªé«˜å¯ç”¨æ—¶é—´é›†ä¸­åº¦åˆ†æå™¨ã€‚è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹æ­¥éª¤å¤„ç†è¾“å…¥æ•°æ®ï¼Œæœ€ç»ˆè¾“å‡ºå¿…é¡»æ˜¯ç¬¦åˆæŒ‡å®š JSON schema çš„çº¯ JSON å¯¹è±¡ï¼Œä¸è¦åŒ…å«ä»»ä½•é¢å¤–æ–‡æœ¬ã€è§£é‡Šæˆ–æ ¼å¼ç¬¦å·ã€‚

### è¾“å…¥æ•°æ®æ ¼å¼

- 24å°æ—¶ï¼ˆ0-23ç‚¹ï¼‰æ¯ä¸ªå°æ—¶çš„å‘Šè­¦æ•°é‡æ•°ç»„ï¼Œä¾‹å¦‚ï¼š`[5,0,3,...,12]`

### é›†ä¸­æ—¶æ®µåˆ¤å®šè§„åˆ™

1. **è¿ç»­æ—¶æ®µ**ï¼šä»…è€ƒè™‘è¿ç»­å°æ—¶ï¼ˆæ—¶æ®µé•¿åº¦â‰¤4å°æ—¶ï¼‰
2. **æ€»é‡é˜ˆå€¼**ï¼šæ—¶æ®µå†…å‘Šè­¦æ€»æ•° â‰¥ å…¨å¤©å‘Šè­¦æ€»é‡çš„ 40%
3. **æ•°é‡é™åˆ¶**ï¼šæœ€å¤š 3 ä¸ªæ—¶æ®µï¼Œä¸”æ—¶æ®µä¸å¯é‡å ã€‚å¦‚æœä¸¤ä¸ªæ—¶æ®µæ˜¯è¿ç»­çš„ï¼Œåº”å½“åˆå¹¶åœ¨ä¸€èµ·ã€‚
4. **å‡åŒ€åˆ†å¸ƒæ—¶**ï¼šè‹¥æ— ç¬¦åˆæ¡ä»¶æ—¶æ®µï¼Œè¾“å‡ºç©ºæ•°ç»„

### è¾“å‡ºè¦æ±‚

- ä»…è¾“å‡º JSON å¯¹è±¡ï¼Œå¿…é¡»ç¬¦åˆæ­¤ schemaï¼š

```json
{
  "type": "object",
  "properties": {
    "timeSpans": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "start": { "type": "integer", "description": "ä»å‡ ç‚¹ï¼ˆåŒ…å«ï¼‰å¼€å§‹" },
          "end": { "type": "integer", "description": "ä»å‡ ç‚¹ï¼ˆåŒ…å«ï¼‰ç»“æŸã€‚start å¯ä»¥ç­‰äº endï¼Œè¡¨ç¤ºé›†ä¸­äºä¸€ä¸ªå°æ—¶" },
          "count": { "type": "integer", "description": "è¡¨ç¤ºè¿™ä¸ªæ—¶é—´æ®µå†…çš„æ•°é‡" }
        },
        "required": ["start", "end", "count"],
        "additionalProperties": false
      }
    }
  }
}
`` `
- ç¤ºä¾‹è¾“å‡ºï¼š`{"timeSpans": [{"start": 9, "end": 11, "count": 35 }, ...]}`

### å¤„ç†æµç¨‹

1. è®¡ç®—å…¨å¤©å‘Šè­¦æ€»é‡ `totalAlerts`
2. æ‰«ææ‰€æœ‰è¿ç»­æ—¶æ®µï¼ˆé•¿åº¦ 1-4 å°æ—¶ï¼‰ï¼Œè®¡ç®—æ—¶æ®µå†…å‘Šè­¦å’Œ `sum`
3. è‹¥ `sum â‰¥ totalAlerts Ã— 0.4` åˆ™æ ‡è®°ä¸ºå€™é€‰æ—¶æ®µ
4. æŒ‰ `sum` é™åºé€‰å–è‡³å¤š 3 ä¸ªéé‡å æ—¶æ®µ
    - è¿ç»­åˆå¹¶: å¦‚æœä¸¤ä¸ªåŒºé—´æ˜¯è¿ç»­çš„ï¼Œåº”å½“åˆå¹¶ã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ªåŒºé—´ {"timeSpans": [{"start": 17,"end": 18,"count": 28},{"start": 19,"end": 19,"count": 5}]}, åº”å½“è¢«åˆå¹¶ä¸º {"timeSpans": [{"start": 17,"end": 19,"count": 33}]}
5. è‹¥æ— åˆæ ¼æ—¶æ®µï¼Œè¾“å‡º `{"timeSpans": []}`

### å‚è€ƒæ ·ä¾‹1

-> è¾“å…¥:

- 0 ç‚¹æœ‰ 0 ä¸ª
- 1 ç‚¹æœ‰ 0 ä¸ª
- 2 ç‚¹æœ‰ 0 ä¸ª
- 3 ç‚¹æœ‰ 0 ä¸ª
- 4 ç‚¹æœ‰ 0 ä¸ª
- 5 ç‚¹æœ‰ 0 ä¸ª
- 6 ç‚¹æœ‰ 0 ä¸ª
- 7 ç‚¹æœ‰ 0 ä¸ª
- 8 ç‚¹æœ‰ 1 ä¸ª
- 9 ç‚¹æœ‰ 10 ä¸ª
- 10 ç‚¹æœ‰ 12 ä¸ª
- 11 ç‚¹æœ‰ 14 ä¸ª
- 12 ç‚¹æœ‰ 16 ä¸ª
- 13 ç‚¹æœ‰ 0 ä¸ª
- 14 ç‚¹æœ‰ 0 ä¸ª
- 15 ç‚¹æœ‰ 4 ä¸ª
- 16 ç‚¹æœ‰ 10 ä¸ª
- 17 ç‚¹æœ‰ 18 ä¸ª
- 18 ç‚¹æœ‰ 20 ä¸ª
- 19 ç‚¹æœ‰ 5 ä¸ª
- 20 ç‚¹æœ‰ 0 ä¸ª
- 21 ç‚¹æœ‰ 0 ä¸ª
- 22 ç‚¹æœ‰ 0 ä¸ª
- 23 ç‚¹æœ‰ 1 ä¸ª

<- è¾“å‡º1: { "timeSpans": [{ "start": 8, "end": 13, "count": 53 }, { "start": 15, "end": 18, "count": 52 }]}
<- è¾“å‡º2: { "timeSpans": [{ "start": 9, "end": 12, "count": 53 }, { "start": 16, "end": 18, "count": 48 }]}
<- è¾“å‡º3: { "timeSpans": [{ "start": 9, "end": 12, "count": 53 }, { "start": 16, "end": 17, "count": 28 }, { "start": 18, "end": 18, "count": 20 }]}

å…¶ä¸­åªæœ‰è¾“å‡º2æ˜¯åˆæ ¼çš„:
- è¾“å‡º1ä¸åˆæ ¼, å› ä¸ºåŒºé—´1æ˜¯[8,13], 8 ç‚¹åªæœ‰ 1 ä¸ª, 13 ç‚¹åªæœ‰ 0 ä¸ª, åœ¨é›†ä¸­åŒºé—´é‡Œå æ¯”è¿‡åˆ†ä½äº†;
- è¾“å‡º2åˆæ ¼, å› ä¸ºåŒºé—´[9,12], è¿™4ä¸ªå°æ—¶çš„æ•°é‡æ˜¾è‘—æ¯”å‘¨å›´é«˜, åŒºé—´[16,18] ä¹Ÿæ˜¾è‘—æ¯”å‘¨å›´é«˜;
- è¾“å‡º3ä¸åˆæ ¼, å› ä¸ºåŒºé—´[16,17]å’Œ[18,18]æ˜¯è¿ç»­çš„ï¼Œåº”å½“åˆå¹¶ä¸º[16,18]

### å‚è€ƒæ ·ä¾‹2

-> è¾“å…¥:

æ˜¨å¤©çš„å‘Šè­¦æ•°é‡æ˜¯ï¼š

- 0 ç‚¹æœ‰ 1 ä¸ª
- 1 ç‚¹æœ‰ 2 ä¸ª
- 2 ç‚¹æœ‰ 3 ä¸ª
- 3 ç‚¹æœ‰ 0 ä¸ª
- 4 ç‚¹æœ‰ 1 ä¸ª
- 5 ç‚¹æœ‰ 2 ä¸ª
- 6 ç‚¹æœ‰ 3 ä¸ª
- 7 ç‚¹æœ‰ 0 ä¸ª
- 8 ç‚¹æœ‰ 1 ä¸ª
- 9 ç‚¹æœ‰ 2 ä¸ª
- 10 ç‚¹æœ‰ 2 ä¸ª
- 11 ç‚¹æœ‰ 1 ä¸ª
- 12 ç‚¹æœ‰ 1 ä¸ª
- 13 ç‚¹æœ‰ 2 ä¸ª
- 14 ç‚¹æœ‰ 3 ä¸ª
- 15 ç‚¹æœ‰ 0 ä¸ª
- 16 ç‚¹æœ‰ 1 ä¸ª
- 17 ç‚¹æœ‰ 2 ä¸ª
- 18 ç‚¹æœ‰ 2 ä¸ª
- 19 ç‚¹æœ‰ 1 ä¸ª
- 20 ç‚¹æœ‰ 0 ä¸ª
- 21 ç‚¹æœ‰ 0 ä¸ª
- 22 ç‚¹æœ‰ 0 ä¸ª
- 23 ç‚¹æœ‰ 1 ä¸ª

<- è¾“å‡º1: {"timeSpans": [{"start": 0, "end": 2, "count": 6}, {"start": 13, "end": 14, "count": 5}]}
<- è¾“å‡º2: {"timeSpans": [{"start": 2, "end": 6, "count": 6}, {"start": 9, "end": 14, "count": 5}]}
<- è¾“å‡º3: {"timeSpans": []}

å…¶ä¸­åªæœ‰è¾“å‡º3æ˜¯åˆæ ¼çš„: ä»æ•°æ®ä¸­å¯ä»¥çœ‹åˆ° 24 å°æ—¶ä¸­å¤§éƒ¨åˆ†éƒ½æœ‰æ•°æ®, ä½†æ˜¯å¤§éƒ¨åˆ†æ•°æ®å˜åŒ–éƒ½æ¯”è¾ƒå¹³ç¼“ï¼ˆæ‰€æœ‰æ•°æ®å–å€¼éƒ½åœ¨ 0-3 ä¹‹é—´ï¼‰ï¼Œæ‰€ä»¥æ²¡æœ‰é›†ä¸­è¶‹åŠ¿ã€‚
```

äºæ˜¯æˆ‘å¾—åˆ°äº†ä¸€ä¸ªè®¡ç®—é›†ä¸­æ—¶æ®µçš„â€œç®—æ³•â€ã€‚

ä» prompt å†…å®¹å¯ä»¥çœ‹å‡ºï¼ŒAI â€œè®¡ç®—â€è¿™ç§ä¸œè¥¿çš„æ—¶å€™ï¼Œæ€»æ˜¯å‡ºä¸€äº›é—®é¢˜ï¼š

- è¾“å‡ºä¸ç¨³å®šï¼ŒåŒæ ·çš„è¾“å…¥ï¼Œç»å¸¸ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„è¾“å‡ºã€‚
- AI ç»™å‡ºçš„é›†ä¸­æ—¶é—´æ®µåŒºé—´ï¼Œå¯èƒ½åŒ…å«ä¸¤ä¸ªç´§æŒ¨åœ¨ä¸€èµ·çš„åŒºé—´ï¼ŒAI åˆä¸ä¼šä¸»åŠ¨å»åˆå¹¶ã€‚

ç°åœ¨è¿™ä¸ªæƒ…å†µä¸æ…ç†æƒ³ï¼Œæ˜¯å› ä¸ºä½¿ç”¨çš„æ˜¯åŸºç¡€æ¨¡å‹ã€‚é™¤äº†ä¸Šé¢ä¸¤ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ä¹‹å¤–ï¼Œè¿˜æœ‰äº›å…¶ä»–ç»†å¾®é—®é¢˜å°±ä¸å•°å—¦äº†ã€‚
ç°åœ¨ä¸€æ¬¡è®¡ç®—ç”¨æ—¶åœ¨ 10s å·¦å³ã€‚å¦‚æœä½¿ç”¨æ¨ç†æ¨¡å‹ï¼Œä¸€æ¬¡â€œè®¡ç®—â€çš„ç”¨æ—¶åŸºæœ¬è¦ 1 åˆ†é’Ÿä»¥ä¸Šã€‚ä¸€ä¸ªæŠ¥å‘Šé‡Œè¦è®¡ç®— 5-8
æ¬¡ï¼Œè¿™ä¸ªæ—¶é—´æ¶ˆè€—æœ‰ç‚¹è®©äººæ— æ³•æ¥å—ã€‚

æˆ‘å°±æƒ³æœ‰æ²¡æœ‰åˆ«çš„åŠæ³•ï¼Œä½†æ˜¯è¿ç»­å‡ å‘¨ï¼Œæˆ‘éƒ½æ²¡æœ‰å¤´ç»ªï¼Œå…ˆç”¨åŸºç¡€æ¨¡å‹å‡‘åˆå§ã€‚

## æ‰‹ç®—ç‰ˆç®—æ³•

å‰å‡ å¤©çªç„¶æƒ³åˆ°ä¸€ä¸ªåŠæ³•ã€‚

### æ€è·¯

æ˜¯è¿™æ ·çš„ï¼š

> æ¯æ¬¡éƒ½é€‰å–åºåˆ—ä¸­æœ€å¤§çš„å€¼ï¼ŒæŠŠå®ƒåˆå¹¶åˆ°é™„è¿‘â€œåŒºé—´â€ä¸­ã€‚å¦‚æœé™„è¿‘æ²¡æœ‰åŒºé—´ï¼Œå°±è®©æœ€å¤§å€¼å•ç‹¬æˆä¸ºåŒºé—´ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿçš„è®¡ç®—è¿‡ç¨‹ï¼š

```js
// åˆæ€
[25, 7, 5, 4, 10, 6, 17, 10, 10, 3, 6, 5, 6, 7, 2, 5, 2, 7, 0, 3, 0, 0, 1, 1]

// é€‰å–æœ€å¤§å€¼ 25ï¼Œå®ƒå‘¨å›´æ²¡æœ‰åŒºé—´ï¼Œæ‰€ä»¥å•ç‹¬æˆåŒºé—´
[[25], 7, 5, 4, 10, 6, 17, 10, 10, 3, 6, 5, 6, 7, 2, 5, 2, 7, 0, 3, 0, 0, 1, 1]

// é€‰å–æœ€å¤§å€¼ 17ï¼Œå®ƒå‘¨å›´æ²¡æœ‰åŒºé—´ï¼Œæ‰€ä»¥å•ç‹¬æˆåŒºé—´
[[25], 7, 5, 4, 10, 6, [17], 10, 10, 3, 6, 5, 6, 7, 2, 5, 2, 7, 0, 3, 0, 0, 1, 1]

// é€‰å–æœ€å¤§å€¼ 10ï¼Œå®ƒå‘¨å›´æœ‰åŒºé—´å°±åŠ å…¥ï¼Œæ²¡åŒºé—´å°±å•ç‹¬æˆä¸ºåŒºé—´
[[25], 7, 5, 4, [10], 6, [17, 10, 10], 3, 6, 5, 6, 7, 2, 5, 2, 7, 0, 3, 0, 0, 1, 1]

// é€‰å–æœ€å¤§å€¼ 7ï¼Œå®ƒå‘¨å›´æœ‰åŒºé—´å°±åŠ å…¥ï¼Œæ²¡åŒºé—´å°±å•ç‹¬æˆä¸ºåŒºé—´
[[25, 7], 5, 4, [10], 6, [17, 10, 10], 3, 6, 5, 6, [7], 2, 5, 2, [7], 0, 3, 0, 0, 1, 1]

// é€‰å–æœ€å¤§å€¼ 6ï¼Œå®ƒå‘¨å›´æœ‰åŒºé—´å°±åŠ å…¥ï¼Œæ²¡åŒºé—´å°±å•ç‹¬æˆä¸ºåŒºé—´
[[25, 7], 5, 4, [10, 6, 17, 10, 10], 3, [6], 5, [6, 7], 2, 5, 2, [7], 0, 3, 0, 0, 1, 1]

// é‡å¤ä¸Šé¢çš„è¿‡ç¨‹
```

é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªåˆ—è¡¨éƒ½åˆå¹¶æˆä¸€ä¸ªåŒºé—´ï¼ˆğŸ˜±ï¼‰ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œ
æ‰€ä»¥éœ€è¦é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ—¶æœºï¼Œè®©è®¡ç®—åœæ­¢ï¼Œé¿å…æŠŠæ‰€æœ‰çš„æ•°å­—éƒ½åŠ å…¥åŒºé—´ã€‚
æˆ‘æƒ³åˆ°äº†ç”¨ä¸­ä½æ•°ä½œä¸ºåœæ­¢æ¡ä»¶ï¼šå¯¹æ‰€æœ‰å¤§äºï¼ˆä¸åŒ…å«ç­‰äºï¼‰ä¸­ä½æ•°çš„æ•°å­—é‡å¤æ‰§è¡Œä¸Šé¢çš„æ­¥éª¤ã€‚

å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œä¸­ä½æ•°æ˜¯ 5ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¡ç®—å®Œ 6 ä¹‹åå°±åœæ­¢ï¼Œå¾—åˆ°ï¼š

```json
[[25, 7], 5, 4, [10, 6, 17, 10, 10], 3, [6], 5, [6, 7], 2, 5, 2, [7], 0, 3, 0, 0, 1, 1]
```

æˆ‘ä»¬æŠŠå…¶ä¸­çš„åŒºé—´ç•™ä¸‹ï¼Œå¾—åˆ°

```json
[[25, 7], [10, 6, 17, 10, 10], [6], [6, 7], [7]]
```

ç°åœ¨æˆ‘ä»¬æœ‰å‡ ä¸ªé€‰æ‹©ï¼š

- å–åŒºé—´æ€»å’Œæœ€å¤§çš„å‰å‡ ä¸ªï¼ˆæ¯”å¦‚å‰ 2 ä¸ªï¼‰
- å–åŒºé—´æ€»å’Œå ä¸€å¤©ä¸­çš„ç™¾åˆ†æ¯”å¤§äºæŸä¸ªé˜ˆå€¼çš„å‡ ä¸ªï¼ˆæ¯”å¦‚ 20%ï¼‰ï¼ˆæˆ‘é€‰çš„æ˜¯è¿™ä¸ªï¼Œæ•ˆæœå°šå¯ï¼‰
- ç”šè‡³å¯ä»¥ç»¼åˆåŒºé—´çš„é•¿åº¦æ¥ç­›é€‰

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å‡ ä¸ªåŒºé—´ï¼Œè¿™äº›åŒºé—´å†…çš„å‘Šè­¦æ•°é‡ï¼Œå ä¸€å¤©ä¸­æ€»çš„å‘Šè­¦æ•°é‡æ¯”é‡è¾ƒå¤§ï¼›
è€Œå®ƒä»¬çš„æ€»é•¿åº¦ä¸ä¼šè¶…è¿‡åŠå¤©ã€‚åŒºé—´é•¿åº¦çŸ­ã€å æ¯”é‡åˆè¾ƒå¤§ï¼Œç®—æ˜¯â€œé›†ä¸­â€å§ã€‚

è¿™æ ·çš„ç®—æ³•å¯¹å˜åŒ–å¹³ç¼“çš„æ•°æ®ï¼Œä¹Ÿæ˜¯é€‚ç”¨çš„ï¼Œå¦‚æœæ•°æ®æ•´ä½“æ³¢åŠ¨ä¸å¤§ï¼Œæˆ–è€…æ²¡æœ‰æ˜æ˜¾çš„é›†ä¸­è¶‹åŠ¿ï¼Œä¼šå¾—ä¸åˆ°ä»»ä½•é›†ä¸­åŒºé—´ã€‚æ¯”å¦‚ï¼š

```json
[1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4]
```

çš„ä¸­ä½æ•°æ˜¯ 2.5ã€‚ç»è¿‡ä¸¤è½®é›†ä¸­åï¼Œæˆ‘ä»¬å¾—åˆ°è¿™æ ·ä¸€äº›åŒºé—´ï¼š

```json
[[3, 4], [3, 4], [3, 4], [3, 4], [3, 4], [3, 4]]
```

è¿™äº›åŒºé—´å æ•´ä½“çš„æ¯”ä¾‹è¿‡ä½ï¼Œéƒ½è¢«æ’é™¤æ‰äº†ã€‚

è¿™ä¸ªç®—æ³•å¹¶ä¸ç®—å®Œç¾ï¼Œæ¯”å¦‚ï¼š
- æ˜¯å¦æœ‰æ¯”ä¸­ä½æ•°æ›´é€‚åˆä½œä¸ºåœæ­¢æ¡ä»¶çš„æ•°å€¼ï¼Ÿ
- åŒºé—´é›†ä¸­çš„è¿‡ç¨‹åœæ­¢åï¼Œæ˜¯å¦æœ‰æ›´å¥½çš„é€‰å–åŒºé—´çš„æ–¹æ³•ï¼Ÿ

æˆ‘ä¸çŸ¥é“ã€‚ä»æˆ‘å†™äº†å‡ åä¸ªæµ‹è¯•ç”¨ä¾‹åå‘ç°ï¼Œé€‰å–ä¸­ä½æ•°ï¼Œç„¶åé€‰å–åŒºé—´å æ€»ä½“æ¯”ä¾‹è¶…è¿‡ 20% çš„åŒºé—´ï¼Œæ•ˆæœè¿˜è¡Œã€‚

ä¸‹é¢æ˜¯æˆ‘å†™çš„ä¸€ä¸ª Java ç‰ˆ

### ä»£ç 

ï¼Œæ²¡æœ‰åšä¼˜åŒ–ï¼Œä¸è¿‡ä¹Ÿå·®ä¸å¤šäº†ï¼š

```java
import java.util.ArrayList;
import java.util.Comparator;
import java.util.LinkedList;
import java.util.List;

public final class DenseSpans {

    public static <E> Item.Value<E> value(double value, E extra) {
        return new Item.Value<>(value, extra);
    }

    public sealed interface Item<E> {
        final class Value<E> implements Item<E> {
            public Value(double value, E extra) {
                this.value = value;
                this.extra = extra;
            }

            public double value;
            public final E extra;

            public double value() { return value; }
            public E extra() { return extra; }
        }

        record Range<E>(LinkedList<Value<E>> values, double sum) implements Item<E> {

            public Value<E> first() { return values.getFirst(); }
            public Value<E> last()  { return values.getLast();  }

            public String rangeStr() {
                if (values.isEmpty()) {
                    return "";
                }
                if (values.size() == 1) {
                    return values.getFirst().extra.toString();
                }
                return String.format("%s-%s", values.getFirst().extra, values.getLast().extra);
            }
        }
    }

    public static <E> List<Item.Range<E>> merge(List<Item.Value<E>> values) {
        return merge(values, 0.2);
    }

    public static <E> List<Item.Range<E>> merge(List<Item.Value<E>> values, double factor) {
        if (values == null || values.size() < 3) {
            return List.of();
        }

        var median = calcMedian(values); // ç®—ä¸­ä½æ•°
//        System.out.printf("ä¸­ä½æ•° %f\n", median);
        var sum = values.stream().mapToDouble(Item.Value::value).sum();

        var doubles = values.stream()
                .filter(item -> item.value() > median) // ç­›é€‰å¤§äºä¸­ä½æ•°çš„å€¼ï¼ˆç­‰äºçš„ä¹Ÿä¸è¦ï¼Œåªè¦å¤§äºçš„ï¼‰
                .map(it -> it.value).distinct()
                .sorted((o1, o2) -> Double.compare(o2, o1)) // å€’åºæ’åº
                .toList();

        List<Item<E>> stage = values.stream().map(it -> (Item<E>) it).toList();
        for (var it : doubles) {
            stage = mergeStage(stage, it);
        }

        return stage.stream()
                .filter(item -> item instanceof Item.Range)
                .map(it -> (Item.Range<E>) it)
                .filter(it -> it.sum > sum * factor) // ç­›é€‰å‡ºå æ¯”è¶…è¿‡ 20% çš„åŒºé—´
                .sorted((o1, o2) -> Double.compare(o2.sum, o1.sum))
                .limit(3)
                .toList();
    }

    private static <E> List<Item<E>> mergeStage(List<Item<E>> items, double value) {
        // æŠŠå€¼å¤§äºæˆ–ç­‰äº value çš„å˜æˆ Range
        List<Item<E>> ranged = items.stream()
                .map(it -> {
                    if (it instanceof Item.Value<E> iv) {
                        if (iv.value >= value) {
                            var list = new LinkedList<Item.Value<E>>();
                            list.add(iv);
                            return new Item.Range<>(list, iv.value);
                        }
                    }
                    return it;
                })
                .toList();

        List<Item<E>> result = new ArrayList<>();
        result.add(ranged.getFirst());

        for (int i = 1; i < ranged.size(); i++) {
            var curr = ranged.get(i);
            var last = result.getLast();
            if (last instanceof Item.Range<E>(LinkedList<Item.Value<E>> lastValues, double lastSum)) {
                if (curr instanceof Item.Range<E>(LinkedList<Item.Value<E>> currValues, double currSum)) {
                    // åˆå¹¶è¿ç»­ä¸¤ä¸ª range
                    var newValues = new LinkedList<>(lastValues);
                    newValues.addAll(currValues);
                    var newRange = new Item.Range<>(newValues, lastSum + currSum);
                    result.removeLast();
                    result.add(newRange);
                } else {
                    result.add(curr);
                }
            } else {
                result.add(curr);
            }
        }
        return result;
    }

    private static final Comparator<Item.Value<?>> VALUE_DESC = (o1, o2) -> Double.compare(o2.value(), o1.value());

    private static <E> double calcMedian(List<Item.Value<E>> values) {
        var sorted = values.stream().sorted(VALUE_DESC).toList();
        var size = sorted.size();
        if (size % 2 == 0) {
            return (sorted.get(size / 2 - 1).value() + sorted.get(size / 2).value()) / 2;
        } else {
            return sorted.get(size / 2).value();
        }
    }
}
```