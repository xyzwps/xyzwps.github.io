---
layout: ../../../layouts/MdxLayout.astro
title: Gateway Offloading pattern
parent:
  name: 返回上级
  path: /cheatsheet/cloud-patterns/
translateFrom:
  url: https://learn.microsoft.com/en-us/azure/architecture/patterns/gateway-offloading
  title: Gateway Offloading pattern - Azure Architecture Center
---

将共享或专用服务功能卸载到网关代理。
这种模式可以通过将共享服务功能（例如使用SSL证书）从应用程序的其他部分转移到网关来简化应用程序开发。

## 问题上下文

一些功能通常跨多个服务使用，这些功能需要配置、管理和维护。
随每个应用程序部署分发的共享或专用服务会增加管理开销并增加部署错误的可能性。
对共享功能的任何更新都必须部署在共享该功能的所有服务中。

正确处理安全问题（令牌验证、加密、SSL证书管理）和其他复杂任务可能需要团队成员具备高度专业化的技能。
例如，必须在所有应用程序实例上配置和部署应用程序所需的证书。对于每个新部署，都必须管理证书以确保其不会过期。
任何即将过期的通用证书都必须在每个应用程序部署上进行更新、测试和验证。

其他常见服务，如身份验证、授权、日志记录、监视或限制，可能难以在大量部署中实现和管理。
为了减少开销和错误的机会，最好整合这种类型的功能。

## 解决方案

将某些功能卸载到网关中，特别是跨领域问题，例如证书管理、身份验证、SSL终止、监控、协议转换或限制。

下图显示了终止入站SSL连接的网关。它代表原始请求者从网关上游的任何HTTP服务器请求数据。

![](https://learn.microsoft.com/en-us/azure/architecture/patterns/_images/gateway-offload.png)

这种模式的好处包括：

- 通过消除分发和维护支持资源（例如Web服务器证书和安全网站配置）的需要来简化服务的开发。
  更简单的配置更容易管理和可扩展性，并使服务升级更简单。

- 允许专门的团队实现需要专业知识的功能，例如安全性。
  这允许您的核心团队专注于应用程序功能，将这些专业但交叉的问题留给相关专家。

- 为请求和响应日志记录和监控提供一些一致性。
  即使服务没有正确检测，也可以配置网关以确保最低级别的监控和日志记录。

## 实现考量

- 确保网关具有高可用性和抗故障能力。通过运行网关的多个实例来避免单点故障。

- 确保网关专为应用程序和端点的容量和扩展要求而设计。确保网关不会成为应用程序的瓶颈并且具有足够的可扩展性。

- 仅卸载整个应用程序使用的功能，例如安全性或数据搬迁。

- 永远不应该将业务逻辑卸载到网关。

- 如果您需要跟踪事务，请考虑为日志记录目的生成相关ID。

## 何时使用

以下场景可使用此模式：

- 应用程序部署具有共同的关注点，例如SSL证书或加密。

- 一种在可能具有不同资源要求的应用程序部署中常见的功能，例如内存资源、存储容量或网络连接。

- 您希望将网络安全、限制或其他网络边界问题等问题的责任转移到更专业的团队。

如果这种模式引入了跨服务的耦合，则它可能不适合。