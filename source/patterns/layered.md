---
title: 分层模式
---

# 网络分层模型

了解过计算机网络的分层模型，就应该了解，不管计算机网络在概念上被分为7层、4层还是5层，分层要遵守一些基本原则：

* 各层之间相互独立，每层只实现一种相对独立的功能
* 每层之间界限自然清晰，易于理解，相互交流尽可能少
* 结构上可分割开。每层都采用最合适的技术实现
* 保持下层对上层的独立性，**上层单向使用下层提供的服务**
* 整个分层结构应该能促进标准化工作

这样的原则，使每层都聚焦于一些相对简单独立的事，各层之间依据协议相互协作来完成整个网络的传输功能。

FIXME: 继续细化

# 代码的分层

代码的分层也遵循类似的思想：

* 各层之间相互独立
* 层内功能简单、清晰、易于理解、易于实现
* **上层单向使用下层提供的服务**，不可越层使用服务
* 分层结构应该能够促进相互写作

## 不分层

如果项目足够简单，可以不对代码进行分层，想到哪写到哪，怎么爽怎么写。因为项目足够简单，所以在维护时，不一定会给维护者造成较大的心智负担。

## 传统分层

传统的做法是分三层：

* 请求处理层（Controller 层）
* 业务处理层（Service 层）
* 数据持久层（DAO 层）

这样的分层有一些问题：Controller 层到底应该有多厚？Service 层的业务是指什么？DAO 层持久化的数据应该算什么？等等。这样的问题如果回答不好，最终往往会沦落到这样一种境地：所有的代码都被堆积到了 Service 层，Controller 层只提供路由和基本的数据校验，DAO 层就是写 SQL。服务层的膨胀导致越来越多的代码被堆积到这里，难以维护。而因为数据持久层的数据身份不明确，往往会导致一个数据对象在各层被反复使用，极大增加了数据处理时的心智负担。为了对数据做标准化处理，又导致了一堆奇怪的“O”出现：VO、DO、BO，让人眼花缭乱。

## DDD 的分层模型

在 DDD 的分层模型中，模型处于核心地位。

FIXME: 继续细化


# 参考

- [代码分层设计 - 知乎](https://zhuanlan.zhihu.com/p/58762886): 相当传统的代码分层方式
- [计算机网络的分层结构、协议、服务和接口 - CSDN](https://blog.csdn.net/weixin_43914604/article/details/104557738)
- [网络分层体系结构 - 博客园](https://www.cnblogs.com/zhouxiangting/p/10651641.html)
- [DDD实战篇：分层架构的代码结构 - Thoughtworks](https://insights.thoughtworks.cn/ddd-layered-architecture/)